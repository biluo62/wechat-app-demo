webpackJsonp([27],{358:function(e,t,a){try{(function(){"use strict";function e(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var c,r,l=n(a(2)),s=n(a(11)),i=n(a(3)),o=n(a(6)),u=n(a(12)),d=n(a(13)),f=a(1),m=n(f),p=n(a(9)),h=a(38),v=a(25),E=n(a(14)),g=n(a(345)),y=n(a(346)),b=e(a(64)),w=e(a(125)),C=e(a(121)),T=n(a(119));a(403);var _=(r=c=function(e){function t(e){(0,i.default)(this,t);var a=(0,u.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e));return a.handleToggleInputType=function(){"txt"===a.state.inputType?a.setState({inputType:"voice"}):a.setState({inputType:"txt"})},a.getTitle=function(e){switch(e.base.type){case b.CHAT_ROOM_TYPE_FRIENDS:return e.base.nickname||e.base.name;case b.CHAT_ROOM_TYPE_GROUP:return(e.base.nickname||e.base.name)+"("+e.chatMemberModel.length+")";case b.CHAT_ROOM_TYPE_SERVICE:return e.base.name}return""},a.renderChatMessage=function(e,t){var n=a.props,c=n.currentChat,r=n.personal,l=void 0===r?{}:r,s=e.concat,i=e.type,o=void 0===i?"":i,u=e.content;return m.default.createElement("div",{className:"chat-row-wrap",key:t},m.default.createElement("div",{className:(0,E.default)("chat-row-wrap-avatar left",{"visibility-hidden":l.wxid===s.wxid})},m.default.createElement("img",{className:"chat-concat-avatar",src:s.headerUrl})),m.default.createElement("div",{className:(0,E.default)("chat-row-wrap-body",o.toLowerCase()+"-chat-body",{personal:l.wxid===s.wxid})},c&&c.base.type===b.CHAT_ROOM_TYPE_GROUP&&c.chatMemberModel&&c.chatMemberModel.length&&m.default.createElement("div",{className:"chat-concat-name"},s.remark||s.nickname),m.default.createElement("div",{className:"wrap-body-content"},"TEXT"===o&&u,"IMAGE"===o&&m.default.createElement("img",{className:"content-image",src:u}))),m.default.createElement("div",{className:(0,E.default)("chat-row-wrap-avatar right",{"visibility-hidden":l.wxid!==s.wxid})},m.default.createElement("img",{className:"chat-concat-avatar",src:s.headerUrl})))},a.state={inputType:"txt"},a}return(0,d.default)(t,e),(0,o.default)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.match,a=e.messagesCache,n=t.params.mid;this.props.fetchChat(n),a[n]||this.props.fetchMessages(n),this.props.personal||this.props.fetchPersonal()}},{key:"render",value:function(){var e=this.props,t=e.currentChat,a=e.match,n=e.messagesCache,c=this.state.inputType;if(!t||t.mid!==a.params.mid)return null;var r=n[a.params.mid]||[];return m.default.createElement("div",{className:"chat-dialogue-wrapper"},m.default.createElement(g.default,{title:this.getTitle(t),back:m.default.createElement(y.default,{history:this.props.history},m.default.createElement("span",{className:"weui-back-centent"},"微信"))}),m.default.createElement("div",{className:"dialogue-content"},m.default.createElement("div",{className:"dialogue-content-body"},r.map(this.renderChatMessage)),m.default.createElement("div",{className:"dialogue-content-footer"},m.default.createElement("i",{className:(0,E.default)("iconfont",{"icon-dialogue-jianpan":"txt"===c,"icon-dialogue-voice":"voice"===c}),onClick:this.handleToggleInputType}),m.default.createElement("div",{className:"chat-way"},"txt"===c&&m.default.createElement("input",{className:"weui-form-control",type:"text"}),"voice"===c&&m.default.createElement("p",{className:"chat-say"},"按住 说话")),m.default.createElement("i",{className:"expression iconfont icon-dialogue-smile"}),m.default.createElement("i",{className:"more iconfont icon-dialogue-jia"}))))}}]),t}(f.Component),c.propTypes={personal:p.default.object,messagesCache:p.default.object,currentChat:p.default.object,fetchChat:p.default.func.isRequired,fetchMessages:p.default.func.isRequired,fetchPersonal:p.default.func.isRequired},r);t.default=(0,h.connectAdvanced)(function(e){var t={},a=(0,v.bindActionCreators)(w,e),n=(0,v.bindActionCreators)(C,e);return function(e,c){var r=e.wechat.chatMain||{},s=(e.wechat.selfMain||{}).personal,i=r.currentChat,o=r.messages,u=(0,l.default)({},c,{personal:s,currentChat:i,messagesCache:o},a,n);return t=T.default.shallowEqual(t,u)?t:u}})(_)}).call(this)}finally{}},403:function(e,t){}});